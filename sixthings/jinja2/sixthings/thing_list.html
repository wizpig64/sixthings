<!doctype html>
<head>
  <title>Six Things</title>
  <script src="https://code.jquery.com/jquery-3.1.0.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <div class="container">
  <h1>Six Things</h1>
  <div class="row">
    <div class="col-sm-4">
      <h2>
        Yesterday<br>
        <small>{{ yesterday['date'].strftime('%B %-d, %Y') }}</small>
      </h2>
      <ul class="list-group">
        {% for thing in yesterday['things'] %}
          {% if thing.done %}
            <li class="list-group-item">
              <button class="btn-xs btn-success button-nothing" id="{{ thing.id }}">
                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
              </button>
              <s>{{ thing.text }}</s>
            </li>
          {% else %}
            <li class="list-group-item">
              <button class="btn-xs btn-info button-done" id="{{ thing.id }}">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
              </button>
              {{ thing.text }}
            </li>
          {% endif %}
        {% endfor %}
        {% if yesterday['things'].count() < 6 %}
          <li class="list-group-item">
            <button class="btn-xs btn-primary button-new">
              <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
            </button>
            <input id="new" class="form-control">
          </li>
        {% endif %}
      </ul>
    </div>
    <div class="col-sm-4">
      <h2>
        Today<br>
        <small>{{ today['date'].strftime('%B %-d, %Y') }}</small>
      </h2>
      <ul class="list-group">
        {% for thing in today['things'] %}
          {% if thing.done %}
            <li class="list-group-item">
              <button class="btn-xs btn-success button-nothing" id="{{ thing.id }}">
                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
              </button>
              <s>{{ thing.text }}</s>
            </li>
          {% else %}
            <li class="list-group-item">
              <button class="btn-xs btn-info button-done" id="{{ thing.id }}">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
              </button>
              {{ thing.text }}
            </li>
          {% endif %}
        {% endfor %}
        {% if today['things'].count() < 6 %}
          <li class="list-group-item">
            <button class="btn-xs btn-primary button-new">
              <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
            </button>
            <input id="new" class="form-control">
          </li>
        {% endif %}
      </ul>
    </div>
    <div class="col-sm-4">
      <h2>
        Tomorrow<br>
        <small>{{ tomorrow['date'].strftime('%B %-d, %Y') }}</small>
      </h2>
      <ul class="list-group">
        {% for thing in tomorrow['things'] %}
          {% if thing.done %}
            <li class="list-group-item">
              <button class="btn-xs btn-success button-nothing" id="{{ thing.id }}">
                <span class="glyphicon glyphicon-ok" aria-hidden="true"></span>
              </button>
              <s>{{ thing.text }}</s>
            </li>
          {% else %}
            <li class="list-group-item">
              <button class="btn-xs btn-info button-done" id="{{ thing.id }}">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
              </button>
              {{ thing.text }}
            </li>
          {% endif %}
        {% endfor %}
        {% if tomorrow['things'].count() < 6 %}
          <li class="list-group-item">
            <button class="btn-xs btn-primary button-new">
              <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
            </button>
            <input id="new" class="form-control">
          </li>
        {% endif %}
      </ul>
    </div>
  </div>
  <script type="text/javascript">
    $('.button-done').click(function(){
      var id = $(this).attr('id')
      $.ajax({
        type: "POST",
        url: id+'/done/',
        data: {
          csrfmiddlewaretoken: '{{ csrf_token }}',
          id: id,
        },
        success: function() {
          location.reload()
        }
      })
    })
    $('.button-new').click(function(){
      var text = $('#new').val()
      if (text) {
        $.ajax({
          type: "POST",
          url: 'new/',
          data: {
            csrfmiddlewaretoken: '{{ csrf_token }}',
            user: '{{ request.user.id }}',
            text: text,
          },
          success: function() {
            location.reload()
          }
        })
      }
    })
  </script>
  </div>
</body>